<script>
document.addEventListener("DOMContentLoaded", function() {
    const svg = document.querySelector(".house-container svg");
    const infoBox = document.getElementById("info-box");

    // Function to resize info box to 50% of SVG height
    function resizeInfoBox() {
        infoBox.style.height = (svg.getBoundingClientRect().height * 0.5) + "px";
    }

    // Initial sizing
    resizeInfoBox();

    // Resize on window change
    window.addEventListener("resize", resizeInfoBox);

    const sharedSuppliers = {
        heading: "<b>Solar & Battery</b> — Local Installers",
        points: [
            '<a href="https://flosolar.au" target="_blank">Flo Solar</a>',
            '<a href="https://stand-alone.co/" target="_blank">Stand-Alone Solutions</a>',
            '<a href="http://transitionelectrics.com.au/" target="_blank">Transition Electrics</a>',
            '<a href="https://pureenergyelectrical.com/" target="_blank">Pure Energy Electrical</a>',
            '<a href="https://microenergysystems.com.au/" target="_blank">Micro Energy Systems Australia</a>',
            '<a href="https://theswitchelectrical.com.au/ target="_blank">The Switch Electrical</a>',
            '<a href="https://www.scsr.net.au/contact" target="_blank">Souther Cross Solar Tuross Heads</a>'
        ]
    };

    // Mapping of group IDs to info box HTML content
    const infoContent = {
        "solar-panels": sharedSuppliers,
        "home-battery": sharedSuppliers,
        "heat-pump": {
            heading: "<b>Heat Pump Water Heater</b> — Local Installers",
            points: [
                'Stuart Matheson from <a href="https://heatpumps.istore.net.au/" target=_"blank">iStore</a> - email at <a href="mailto:Stuart.Matheson@istore.net.au" target="_blank">Stuart.Matheson@istore.net.au</a>',
                'Adam Prentice Plumbing - email at <a href="mailto:adamprenticeplumbing@gmail.com" target="_blank">adamprenticeplumbing@gmail.com</a>'
            ]
        },
        "aircon": {
            heading: "<b>Air-Conditioning</b> — Local Installers",
            points: [
                '<a href="https://www.mbair.com.au/" target="_blank">MBA Air Conditioning Bega Valley</a>',
                '<a href="https://bermaguirefrigerationandairconditioning.com.au/" target="_blank">Bermagui Refrigeration & Airconditioning</a>'
            ]
        },
        "insulation-roof": {
            heading: "<b>Insulation</b> - Local Installers",
            points: [
                'Haydon Samuels - email at <a href="mailto:handyhaydon@gmail.com" target="_blank">handyhaydon@gmail.com</a>'
            ]
        },
        "ev-charger": {
            heading: "EV Chargers (EVSE)</b> - Local Installers",
            points: [
                '<a href="eastmanelectrical.au" target="_blank">Eastman Electrical (Bega)</a>'
            ]
        }
    };


    // --- 2. Pseudo-random generator (Mulberry32) ---
    function mulberry32(seed) {
    return function() {
        let t = (seed += 0x6D2B79F5);
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
    };
    }

    // --- 3. Deterministic shuffle ---
    function shuffleArray(array, seed) {
    let rng = mulberry32(seed);
    let shuffled = array.slice();
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(rng() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
    }

    // --- 4. Get daily seed (changes once per day) ---
    function getDailySeed() {
    const today = new Date();
    return today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
    }


    // --- STEP 5: Apply interactivity ---
    svg.querySelectorAll('g').forEach(group => {
        const id = group.id;
        if (id && infoContent[id]) {
            group.style.cursor = "pointer";

            group.addEventListener('click', () => {
                const info = infoContent[id];
                const shuffledPoints = shuffleArray(info.points, rng);
                const html = `
                    ${info.heading}
                    <ul>
                    ${shuffledPoints.map(p => `<li>${p}</li>`).join('')}
                    </ul>
                `;
                infoBox.innerHTML = html;
            });

            group.addEventListener('mouseenter', () => {
                group.style.opacity = 0.7;  // hover effect
            });

            group.addEventListener('mouseleave', () => {
                group.style.opacity = 1;
            });
        }
    });
});
</script>